function getMycookie(){var t=JSON.parse($.cookie("user")),e=[];$.each(t,function(t){"index"!=t&&e.push(t)});for(var i=0;i<e.length-1;i++)for(var o=0;o<e.length-1;o++)if(t[e[i]]<t[e[i+1]]){var s=e[i];e[i]=e[i+1],e[i+1]=s}return e[0]}function endBuy(){var t=Math.floor(60*Math.random()),e=Math.floor(60*Math.random()),i=Math.floor(50*Math.random()),o=Math.floor(60*Math.random()),s=Math.floor(60*Math.random()),a="json/detail-List.json",r={dataType:"json",success:function(a){var r=a[0].list[t],c=a[1].list[e],l=a[2].list[i],n=a[0].list[o],d=a[1].list[s],u={list:[{sr:r.sr,productNmae:r.productNmae,productPrice:r.productPrice,usedPrice:r.usedPrice},{sr:c.sr,productNmae:c.productNmae,productPrice:c.productPrice,usedPrice:c.usedPrice},{sr:l.sr,productNmae:l.productNmae,productPrice:l.productPrice,usedPrice:l.usedPrice},{sr:n.sr,productNmae:n.productNmae,productPrice:n.productPrice,usedPrice:n.usedPrice},{sr:d.sr,productNmae:d.productNmae,productPrice:d.productPrice,usedPrice:d.usedPrice}]},h=template("endingBuy",u);$(".endingBuy").html(h)}};$.ajax(a,r)}function xl(){var t=location.href;Href=t.split("?")[1];var e="json/detail-List.json",i=0,o={dataType:"json",success:function(t){var e=t[0].list;$.each(e,function(e){if(this.hreflang&&(i=parseInt(this.hreflang),i==Href)){var o=this.sr,s=this.productNmae;$("title").text(s);var a=this.productPrice,r=template("little",t[0].list[e]);$("#artemp2").html(r);var c=template("detailBottom",t[0].list[e]);$("#detail-bottom1").html(c),Most(),$(".addCart").click(function(){if($.cookie("flag"))if($(".b2").html().length<1)alert("请选择尺码");else{var t=$(".b1").text(),e=$(".b2").text(),i=$(".mostBuy input").val(),r={sr:o,Name:s,price:a,color:t,size:e,count:i};getProduct(r)}else alert("请先登录")})}})},error:function(){alert("失败")},complete:function(){}};$.ajax(e,o)}function detailBottom(){}function evaluation(){var t="json/evaluation.json",e={dataType:"json",success:function(t){var e=template("evaluation",t);$(".evaluate3").html(e),$(".productEvaluate-a").click(function(){$(this).children().first().text("已赞").next().text("(1)")})}};$.ajax(t,e)}function Most(){$(".glass").mousemove(function(t){var e=t.offsetX-75,i=t.offsetY-70;e=Math.max(0,Math.min(e,$(".glass").width()-$(".little-glass").width())),i=Math.max(0,Math.min(i,$(".glass").height()-$(".little-glass").height())),$(".little-glass").css({display:"block",left:e+"px",top:i+"px"}),$(".detailMian-left-glass").css({display:"block"});var o=e/($(".glass").width()-$(".little-glass").width()),s=i/($(".glass").height()-$(".little-glass").height()),a=($(".detailMian-left-img1").width()-$(".detailMian-left-glass").width())*o,r=($(".detailMian-left-img1").height()-$(".detailMian-left-glass").height())*s;$(".detailMian-left-img1").css({left:-a+"px",top:-r+"px"})}).mouseout(function(){$(".little-glass").css("display","none"),$(".detailMian-left-glass").css({display:"none"})}),$(".detailMian-left-ul li").mouseenter(function(){$(this).css("borderColor","red").siblings().css("borderColor","#ddd");var t=$(this).index()+1;$(".detailMian-left-img").attr("src","images/detail/"+Href+t+".jpg"),$(".detailMian-left-img1").attr("src","images/detail/big"+Href+t+".jpg")});for(var t=0;t<12;t++)$(".shareDiv span").eq(t).css({backgroundPosition:t*-16+"px 0px"});$(".detail-share-ul-li1").hover(function(){$(".shareDiv").css({display:"block"})},function(){$(".shareDiv").css({display:"none"})}),$(".buyColor img").click(function(){$(".buyColor img").css("border","1px solid white"),$(this).css({border:"1px solid red"}),$(".mostBuy .b1").html($(this).attr("alt"))});var e=!1;$(".buySize ul li").click(function(){e=!0,$(this).css("border","1px solid red").siblings().css("border","1px solid #ddd"),$(".mostBuy .b2").html($(this).html())});var i=1;$(".mostBuy").children().first().mousedown(function(){i=parseInt($(this).next().val()),i--,i<=1?($(this).next().val(0),i=1):$(this).next().val(i)}),$(".fk").mousedown(function(){i=parseInt($(this).prev().val()),i++,$(this).prev().val(i)}),$(".buyNow").hover(function(){$(this).css("background","red").css("color","white")},function(){$(this).css("background","white").css("color","#e60012")}),$(".KKK ul li").eq(0).css({background:"#cc0011",border:"1px solid #cc0011",color:"white"}),$(".KKK ul li").click(function(){$(this).css({background:"#cc0011",border:"1px solid #cc0011",color:"white"}).siblings().css({background:"#fff",border:"1px solid #ccc",color:"#000"})})}function getProduct(t){var e="http://10.17.158.241:8081/Product/GetProductById_get",i={dataType:"jsonP",data:{Id:getMycookie(),type:"Product"},success:function(e){if(e){var i=JSON.parse(e.Data),o=!1;$.each(i,function(){this.Name==t.Name&&this.color==t.color&&this.size==t.size&&(this.count=parseInt(t.count)+parseInt(this.count),o=!0,updateProduct(i))}),o||(i.push(t),updateProduct(i))}else{var s=[];s.push(t),updateProduct(s)}},complete:function(t){}};$.ajax(e,i)}function updateProduct(t){var e="http://10.17.158.241:8081/Product/CreateUpdateProduct_post",i={type:"post",data:{Id:getMycookie(),datajson:JSON.stringify(t),type:"Product"},success:function(t){t.Data},error:function(){},complete:function(){alert("加入购物车成功!"),getCount()}};$.ajax(e,i)}function getCount(){var t="http://10.17.158.241:8081/Product/GetProductById_get",e={dataType:"jsonP",data:{Id:getMycookie(),type:"Product"},success:function(t){if(t){var e=JSON.parse(t.Data),i=0;$.each(e,function(){i+=parseInt(this.count)}),$(".top2-right-shop-sp1").html(i)}else $(".top2-right-shop-sp1").html("0")},complete:function(t){}};$.ajax(t,e)}$(".right-button1").click(function(){var t=Math.floor(60*Math.random()),e=Math.floor(60*Math.random()),i=Math.floor(60*Math.random()),o="json/detail-List.json",s={dataType:"json",success:function(o){var s=o[1].list[t],a=o[1].list[e],r=o[1].list[i],c={list:[{sr:s.sr,productPrice:s.productPrice},{sr:a.sr,productPrice:a.productPrice},{sr:r.sr,productPrice:r.productPrice}]};console.log(c);var l=template("detailMain-right",c);console.log(c),$(".detailMian-right-main").html(l)}};$.ajax(o,s)}),$(".right-button2").click(function(){var t=Math.floor(60*Math.random()),e=Math.floor(60*Math.random()),i=Math.floor(60*Math.random()),o="json/detail-List.json",s={dataType:"json",success:function(o){var s=o[1].list[t],a=o[1].list[e],r=o[1].list[i],c={list:[{sr:s.sr,productPrice:s.productPrice},{sr:a.sr,productPrice:a.productPrice},{sr:r.sr,productPrice:r.productPrice}]};console.log(c);var l=template("detailMain-right",c);console.log(c),$(".detailMian-right-main").html(l)}};$.ajax(o,s)}),$(".detailMain2-left").click(function(){endBuy()}),$(".detailMain2-right").click(function(){endBuy()}),endBuy(),xl();var Href;detailBottom(),evaluation(),$(".KKK ul li").eq(0).click(function(){$("#detail-bottom1").css("display","block"),$("#detail-bottom2").css("display","none")}),$(".KKK ul li").eq(1).click(function(){$("#detail-bottom2").css("display","block"),$("#detail-bottom1").css("display","none")});